<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.Cinema_Management_System.Movie.dao.MovieDao"><!--namespace:定义一个操作包  -->
    <select id="selectMovieAll" resultType="com.Cinema_Management_System.Movie.entity.Movie">
        select *
        from Cinema_movie
        limit #{pageStart},#{pageNum}
    </select>

    <select id="selectMovieByName" resultType="com.Cinema_Management_System.Movie.entity.Movie">
        select *
        from Cinema_movie
        where movie_name = #{movieName}
    </select>

    <select id="selectMovieByType" resultType="com.Cinema_Management_System.Movie.entity.Movie">
        select *
        from Cinema_movie
        <where>
            <if test="timeType == 'zzry'">
                movie_release_time &lt;= #{nowDate}
            </if>
            <if test="timeType == 'jjsy'">
                movie_release_time &gt;= #{nowDate}
            </if>
        </where>
        <if test="selectType == 'byhot' or selectType == 'bywantnum'">
            order by wants_num desc
        </if>
        <if test="selectType == 'bytime'">
            order by movie_release_time
        </if>
        <if test="selectType == 'byscore'">
            order by movie_score desc
        </if>
        limit #{pageStart},#{pageNum}
    </select>

    <delete id="deleteMovie" parameterType="integer">
        delete from Cinema_movie
        where movie_id = #{movieId}
    </delete>

    <delete id="deleteMovies" parameterType="list">
        delete from Cinema_movie where movie_id in
        <foreach collection="list" index="index" item="item" open="(" separator="," close=")">#{item}</foreach>
    </delete>

    <update id="updateMovie">
        update Cinema_movie
        set movie_id = #{movieId},movie_name = #{movieName},movie_actor = #{movieActor},movie_des = #{movieDes},
        movie_director = #{movieDirector},movie_picture = #{moviePicture},movie_release_time = #{movieReleaseTime},
        movie_score = #{movieScore},movie_time = #{movieTime},movie_type = #{movieType},wants_num = #{wantsNum}
        where movie_id = #{movieId}
    </update>

    <insert id="insertMovie">
        insert into Cinema_movie(movie_id,movie_name,movie_actor,movie_des,movie_director,movie_picture,movie_release_time,movie_score,movie_time,movie_type,wants_num)
        value (#{movieId},#{movieName},#{movieActor},#{movieDes},#{movieDirector},#{moviePicture},#{movieReleaseTime},#{movieScore},#{movieTime},#{movieType},#{wantsNum})
    </insert>
</mapper>